<!DOCTYPE html>

<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TaroAI</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #1a1a1a;
            --bg-card: #252525;
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --accent: #8b5cf6;
            --accent-hover: #7c3aed;
            --border: #333333;
        }

```
    [data-theme="light"] {
        --bg-primary: #f5f5f5;
        --bg-secondary: #ffffff;
        --bg-card: #ffffff;
        --text-primary: #0a0a0a;
        --text-secondary: #666666;
        --accent: #8b5cf6;
        --accent-hover: #7c3aed;
        --border: #e0e0e0;
    }
    
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }
    
    body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        background: var(--bg-primary);
        color: var(--text-primary);
        min-height: 100vh;
        padding: 16px;
        transition: background 0.3s, color 0.3s;
    }
    
    .container {
        max-width: 600px;
        margin: 0 auto;
    }
    
    .header {
        text-align: center;
        margin-bottom: 32px;
        padding-top: 20px;
    }
    
    .logo {
        font-size: 64px;
        margin-bottom: 12px;
    }
    
    .title {
        font-size: 32px;
        font-weight: 600;
        margin-bottom: 4px;
        letter-spacing: -0.5px;
    }
    
    .subtitle {
        color: var(--text-secondary);
        font-size: 14px;
    }
    
    .theme-toggle {
        position: fixed;
        top: 20px;
        right: 20px;
        width: 44px;
        height: 44px;
        background: var(--bg-card);
        border: 1px solid var(--border);
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        font-size: 20px;
        z-index: 1000;
        transition: all 0.3s;
    }
    
    .theme-toggle:hover {
        background: var(--bg-secondary);
        transform: scale(1.05);
    }
    
    .card {
        background: var(--bg-card);
        border: 1px solid var(--border);
        border-radius: 16px;
        padding: 20px;
        margin-bottom: 16px;
        transition: all 0.3s;
    }
    
    h2 {
        font-size: 20px;
        font-weight: 600;
        margin-bottom: 16px;
    }
    
    .spread-btn {
        width: 100%;
        padding: 16px;
        margin-bottom: 12px;
        background: var(--bg-secondary);
        border: 1px solid var(--border);
        border-radius: 12px;
        color: var(--text-primary);
        cursor: pointer;
        transition: all 0.2s;
        display: flex;
        align-items: center;
        justify-content: space-between;
        font-size: 15px;
    }
    
    .spread-btn:hover {
        border-color: var(--accent);
        transform: translateY(-2px);
    }
    
    .spread-name {
        font-weight: 500;
    }
    
    .spread-count {
        color: var(--text-secondary);
        font-size: 14px;
    }
    
    .primary-btn {
        width: 100%;
        padding: 14px;
        background: var(--accent);
        border: none;
        border-radius: 12px;
        color: white;
        font-size: 15px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s;
    }
    
    .primary-btn:hover {
        background: var(--accent-hover);
    }
    
    .primary-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }
    
    .back-btn {
        background: none;
        border: none;
        color: var(--text-secondary);
        font-size: 15px;
        cursor: pointer;
        margin-bottom: 16px;
        padding: 8px 0;
        transition: color 0.2s;
    }
    
    .back-btn:hover {
        color: var(--text-primary);
    }
    
    input, textarea {
        width: 100%;
        padding: 12px;
        margin-bottom: 16px;
        background: var(--bg-secondary);
        border: 1px solid var(--border);
        border-radius: 12px;
        color: var(--text-primary);
        font-size: 15px;
        font-family: inherit;
        transition: all 0.2s;
    }
    
    input:focus, textarea:focus {
        outline: none;
        border-color: var(--accent);
    }
    
    input::placeholder, textarea::placeholder {
        color: var(--text-secondary);
    }
    
    label {
        display: block;
        margin-bottom: 8px;
        font-size: 14px;
        color: var(--text-secondary);
        font-weight: 500;
    }
    
    .card-display {
        display: flex;
        justify-content: center;
        gap: 12px;
        margin: 24px 0;
        flex-wrap: wrap;
    }
    
    .tarot-card {
        width: 100px;
        height: 140px;
        background: var(--bg-secondary);
        border: 1px solid var(--border);
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 56px;
        transition: all 0.3s;
    }
    
    .tarot-card.empty {
        opacity: 0.3;
    }
    
    .tarot-card.drawn {
        border-color: var(--accent);
        background: var(--bg-card);
    }
    
    .card-info {
        padding: 16px;
        background: var(--bg-secondary);
        border-radius: 12px;
        margin-bottom: 12px;
    }
    
    .card-name {
        font-size: 16px;
        font-weight: 600;
        margin-bottom: 4px;
    }
    
    .card-keywords {
        font-size: 13px;
        color: var(--text-secondary);
    }
    
    .interpretation {
        line-height: 1.6;
        font-size: 15px;
        color: var(--text-primary);
    }
    
    .interpretation p {
        margin-bottom: 12px;
    }
    
    .loading {
        text-align: center;
        padding: 32px;
    }
    
    .spinner {
        font-size: 48px;
        animation: spin 1.5s linear infinite;
    }
    
    @keyframes spin {
        100% { transform: rotate(360deg); }
    }
    
    .loading-text {
        margin-top: 12px;
        color: var(--text-secondary);
        font-size: 14px;
    }
    
    .hidden {
        display: none;
    }
    
    .nav-buttons {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
    }
    
    .nav-btn {
        padding: 14px;
        background: var(--bg-card);
        border: 1px solid var(--border);
        border-radius: 12px;
        color: var(--text-primary);
        cursor: pointer;
        transition: all 0.2s;
        font-size: 14px;
    }
    
    .nav-btn:hover {
        border-color: var(--accent);
    }
    
    .history-item {
        background: var(--bg-secondary);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 16px;
        margin-bottom: 12px;
    }
    
    .history-header {
        display: flex;
        justify-content: space-between;
        margin-bottom: 12px;
        font-size: 14px;
    }
    
    .history-spread {
        font-weight: 500;
    }
    
    .history-date {
        color: var(--text-secondary);
        font-size: 13px;
    }
    
    .history-cards {
        font-size: 28px;
        margin: 8px 0;
        letter-spacing: 4px;
    }
    
    .history-question {
        font-size: 13px;
        color: var(--text-secondary);
        font-style: italic;
        margin-top: 8px;
    }
    
    .learn-item {
        background: var(--bg-secondary);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 16px;
        margin-bottom: 12px;
        display: flex;
        align-items: center;
        gap: 16px;
    }
    
    .learn-emoji {
        font-size: 40px;
        min-width: 50px;
        text-align: center;
    }
    
    .learn-info {
        flex: 1;
    }
    
    .learn-name {
        font-weight: 500;
        margin-bottom: 4px;
        font-size: 15px;
    }
    
    .learn-keywords {
        font-size: 13px;
        color: var(--text-secondary);
    }
    
    .empty-state {
        text-align: center;
        padding: 48px 20px;
    }
    
    .empty-icon {
        font-size: 56px;
        margin-bottom: 12px;
        opacity: 0.5;
    }
    
    .empty-text {
        color: var(--text-secondary);
        font-size: 14px;
    }
    
    .ai-badge {
        display: inline-block;
        background: var(--accent);
        color: white;
        font-size: 11px;
        padding: 4px 8px;
        border-radius: 6px;
        font-weight: 500;
        margin-left: 8px;
    }
</style>
```

</head>
<body>
    <div class="theme-toggle" onclick="toggleTheme()" id="theme-toggle">üåô</div>

```
<!-- –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω -->
<div id="home-screen">
    <div class="container">
        <div class="header">
            <div class="logo">üîÆ</div>
            <div class="title">TaroAI</div>
            <div class="subtitle">–ì–∞–¥–∞–Ω–∏–µ –Ω–∞ –∫–∞—Ä—Ç–∞—Ö –¢–∞—Ä–æ</div>
        </div>
        
        <div class="card">
            <h2>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞—Å–∫–ª–∞–¥</h2>
            <button class="spread-btn" onclick="selectSpread('daily', 1, '–ö–∞—Ä—Ç–∞ –¥–Ω—è')">
                <span class="spread-name">üåô –ö–∞—Ä—Ç–∞ –¥–Ω—è</span>
                <span class="spread-count">1 –∫–∞—Ä—Ç–∞</span>
            </button>
            
            <button class="spread-btn" onclick="selectSpread('three', 3, '–¢—Ä–∏ –∫–∞—Ä—Ç—ã')">
                <span class="spread-name">‚≠ê –¢—Ä–∏ –∫–∞—Ä—Ç—ã</span>
                <span class="spread-count">3 –∫–∞—Ä—Ç—ã</span>
            </button>
            
            <button class="spread-btn" onclick="selectSpread('love', 3, '–õ—é–±–æ–≤—å')">
                <span class="spread-name">üíï –õ—é–±–æ–≤—å</span>
                <span class="spread-count">3 –∫–∞—Ä—Ç—ã</span>
            </button>
            
            <button class="spread-btn" onclick="selectSpread('career', 3, '–ö–∞—Ä—å–µ—Ä–∞')">
                <span class="spread-name">üíº –ö–∞—Ä—å–µ—Ä–∞</span>
                <span class="spread-count">3 –∫–∞—Ä—Ç—ã</span>
            </button>
            
            <button class="spread-btn" onclick="selectSpread('finance', 3, '–§–∏–Ω–∞–Ω—Å—ã')">
                <span class="spread-name">üí∞ –§–∏–Ω–∞–Ω—Å—ã</span>
                <span class="spread-count">3 –∫–∞—Ä—Ç—ã</span>
            </button>
        </div>
        
        <div class="nav-buttons">
            <button class="nav-btn" onclick="showHistory()">üìú –ò—Å—Ç–æ—Ä–∏—è</button>
            <button class="nav-btn" onclick="showLearn()">üìñ –ö–∞—Ä—Ç—ã</button>
        </div>
    </div>
</div>

<!-- –≠–∫—Ä–∞–Ω –≤–æ–ø—Ä–æ—Å–∞ -->
<div id="question-screen" class="hidden">
    <div class="container">
        <button class="back-btn" onclick="goHome()">‚Üê –ù–∞–∑–∞–¥</button>
        
        <div class="card">
            <h2 id="spread-title">–†–∞—Å–∫–ª–∞–¥</h2>
            
            <label>–í–∞—à –≤–æ–ø—Ä–æ—Å</label>
            <textarea id="question-input" placeholder="–ó–∞–¥–∞–π—Ç–µ —Å–≤–æ–π –≤–æ–ø—Ä–æ—Å..." rows="3"></textarea>
            
            <button class="primary-btn" onclick="startDrawing()">
                –í—ã—Ç—è–Ω—É—Ç—å –∫–∞—Ä—Ç—ã
            </button>
        </div>
    </div>
</div>

<!-- –≠–∫—Ä–∞–Ω —Å –∫–∞—Ä—Ç–∞–º–∏ -->
<div id="cards-screen" class="hidden">
    <div class="container">
        <button class="back-btn" onclick="newReading()">‚Üê –ù–æ–≤—ã–π —Ä–∞—Å–∫–ª–∞–¥</button>
        
        <h2 style="text-align: center; margin-bottom: 20px;" id="result-title">–í–∞—à–∏ –∫–∞—Ä—Ç—ã</h2>
        
        <div class="card-display" id="cards-container"></div>
        
        <div id="cards-info"></div>
        
        <div id="interpretation-container"></div>
    </div>
</div>

<!-- –≠–∫—Ä–∞–Ω –∏—Å—Ç–æ—Ä–∏–∏ -->
<div id="history-screen" class="hidden">
    <div class="container">
        <button class="back-btn" onclick="goHome()">‚Üê –ù–∞–∑–∞–¥</button>
        
        <h2 style="margin-bottom: 20px;">–ò—Å—Ç–æ—Ä–∏—è —Ä–∞—Å–∫–ª–∞–¥–æ–≤</h2>
        
        <div id="history-list"></div>
    </div>
</div>

<!-- –≠–∫—Ä–∞–Ω –æ–±—É—á–µ–Ω–∏—è -->
<div id="learn-screen" class="hidden">
    <div class="container">
        <button class="back-btn" onclick="goHome()">‚Üê –ù–∞–∑–∞–¥</button>
        
        <h2 style="margin-bottom: 20px;">–°—Ç–∞—Ä—à–∏–µ –ê—Ä–∫–∞–Ω—ã</h2>
        
        <div id="learn-list"></div>
    </div>
</div>

<script>
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
    if (window.Telegram && window.Telegram.WebApp) {
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();
        tg.enableClosingConfirmation();
    }

    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–º–æ–π
    function toggleTheme() {
        const body = document.body;
        const toggle = document.getElementById('theme-toggle');
        const currentTheme = body.getAttribute('data-theme');
        
        if (currentTheme === 'light') {
            body.removeAttribute('data-theme');
            toggle.textContent = 'üåô';
            localStorage.setItem('theme', 'dark');
        } else {
            body.setAttribute('data-theme', 'light');
            toggle.textContent = '‚òÄÔ∏è';
            localStorage.setItem('theme', 'light');
        }
    }
    
    // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–º—ã
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'light') {
        document.body.setAttribute('data-theme', 'light');
        document.getElementById('theme-toggle').textContent = '‚òÄÔ∏è';
    }

    // –î–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç
    const tarotCards = [
        { id: 0, name: '–®—É—Ç', emoji: 'üÉè', keywords: '–Ω–æ–≤–æ–µ –Ω–∞—á–∞–ª–æ, —Å–ø–æ–Ω—Ç–∞–Ω–Ω–æ—Å—Ç—å, —Å–≤–æ–±–æ–¥–∞' },
        { id: 1, name: '–ú–∞–≥', emoji: 'üé©', keywords: '–º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ, —Å–∏–ª–∞ –≤–æ–ª–∏, –¥–µ–π—Å—Ç–≤–∏–µ' },
        { id: 2, name: '–í–µ—Ä—Ö–æ–≤–Ω–∞—è –ñ—Ä–∏—Ü–∞', emoji: 'üîÆ', keywords: '–∏–Ω—Ç—É–∏—Ü–∏—è, —Ç–∞–π–Ω–∞, –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –≥–æ–ª–æ—Å' },
        { id: 3, name: '–ò–º–ø–µ—Ä–∞—Ç—Ä–∏—Ü–∞', emoji: 'üëë', keywords: '–∏–∑–æ–±–∏–ª–∏–µ, –º–∞—Ç–µ—Ä–∏–Ω—Å—Ç–≤–æ, —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ' },
        { id: 4, name: '–ò–º–ø–µ—Ä–∞—Ç–æ—Ä', emoji: 'üèõÔ∏è', keywords: '–∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –∫–æ–Ω—Ç—Ä–æ–ª—å' },
        { id: 5, name: '–ò–µ—Ä–æ—Ñ–∞–Ω—Ç', emoji: '‚õ™', keywords: '—Ç—Ä–∞–¥–∏—Ü–∏–∏, –∑–Ω–∞–Ω–∏–µ, –Ω–∞—Å—Ç–∞–≤–Ω–∏—á–µ—Å—Ç–≤–æ' },
        { id: 6, name: '–í–ª—é–±–ª–µ–Ω–Ω—ã–µ', emoji: 'üíë', keywords: '–ª—é–±–æ–≤—å, –≤—ã–±–æ—Ä, –≥–∞—Ä–º–æ–Ω–∏—è' },
        { id: 7, name: '–ö–æ–ª–µ—Å–Ω–∏—Ü–∞', emoji: 'üèá', keywords: '–ø–æ–±–µ–¥–∞, –∫–æ–Ω—Ç—Ä–æ–ª—å, –¥–≤–∏–∂–µ–Ω–∏–µ –≤–ø–µ—Ä–µ–¥' },
        { id: 8, name: '–°–∏–ª–∞', emoji: 'ü¶Å', keywords: '–º—É–∂–µ—Å—Ç–≤–æ, —Ç–µ—Ä–ø–µ–Ω–∏–µ, –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Å–∏–ª–∞' },
        { id: 9, name: '–û—Ç—à–µ–ª—å–Ω–∏–∫', emoji: 'üïØÔ∏è', keywords: '–æ–¥–∏–Ω–æ—á–µ—Å—Ç–≤–æ, –ø–æ–∏—Å–∫ –∏—Å—Ç–∏–Ω—ã, –º—É–¥—Ä–æ—Å—Ç—å' },
        { id: 10, name: '–ö–æ–ª–µ—Å–æ –§–æ—Ä—Ç—É–Ω—ã', emoji: 'üé°', keywords: '—Å—É–¥—å–±–∞, –∏–∑–º–µ–Ω–µ–Ω–∏—è, —Ü–∏–∫–ª—ã' },
        { id: 11, name: '–°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å', emoji: '‚öñÔ∏è', keywords: '–±–∞–ª–∞–Ω—Å, –∏—Å—Ç–∏–Ω–∞, –∫–∞—Ä–º–∞' },
        { id: 12, name: '–ü–æ–≤–µ—à–µ–Ω–Ω—ã–π', emoji: 'üôÉ', keywords: '–∂–µ—Ä—Ç–≤–∞, –Ω–æ–≤–∞—è –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∞, –ø–∞—É–∑–∞' },
        { id: 13, name: '–°–º–µ—Ä—Ç—å', emoji: 'üíÄ', keywords: '—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è, –æ–∫–æ–Ω—á–∞–Ω–∏–µ, –Ω–æ–≤–æ–µ –Ω–∞—á–∞–ª–æ' },
        { id: 14, name: '–£–º–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å', emoji: 'üßò', keywords: '–±–∞–ª–∞–Ω—Å, —Ç–µ—Ä–ø–µ–Ω–∏–µ, —É–º–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å' },
        { id: 15, name: '–î—å—è–≤–æ–ª', emoji: 'üòà', keywords: '–∏—Å–∫—É—à–µ–Ω–∏–µ, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å, –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–º' },
        { id: 16, name: '–ë–∞—à–Ω—è', emoji: 'üè∞', keywords: '—Ä–∞–∑—Ä—É—à–µ–Ω–∏–µ, –≤–Ω–µ–∑–∞–ø–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω—ã, –æ—Ç–∫—Ä–æ–≤–µ–Ω–∏–µ' },
        { id: 17, name: '–ó–≤–µ–∑–¥–∞', emoji: '‚≠ê', keywords: '–Ω–∞–¥–µ–∂–¥–∞, –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ, –∏—Å—Ü–µ–ª–µ–Ω–∏–µ' },
        { id: 18, name: '–õ—É–Ω–∞', emoji: 'üåô', keywords: '–∏–ª–ª—é–∑–∏–∏, –ø–æ–¥—Å–æ–∑–Ω–∞–Ω–∏–µ, —Å—Ç—Ä–∞—Ö–∏' },
        { id: 19, name: '–°–æ–ª–Ω—Ü–µ', emoji: '‚òÄÔ∏è', keywords: '—Ä–∞–¥–æ—Å—Ç—å, —É—Å–ø–µ—Ö, –ø–æ–∑–∏—Ç–∏–≤' },
        { id: 20, name: '–°—É–¥', emoji: 'üìØ', keywords: '–≤–æ–∑—Ä–æ–∂–¥–µ–Ω–∏–µ, –ø—Ä–æ—â–µ–Ω–∏–µ, –ø—Ä–∏–∑–≤–∞–Ω–∏–µ' },
        { id: 21, name: '–ú–∏—Ä', emoji: 'üåç', keywords: '–∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ, –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ, —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å' }
    ];
    
    let currentSpread = { type: '', count: 0, name: '' };
    let drawnCards = [];
    let history = JSON.parse(localStorage.getItem('tarotHistory') || '[]');
    
    function goHome() {
        hideAllScreens();
        document.getElementById('home-screen').classList.remove('hidden');
    }
    
    function hideAllScreens() {
        document.querySelectorAll('[id$="-screen"]').forEach(screen => {
            screen.classList.add('hidden');
        });
    }
    
    function newReading() {
        goHome();
        document.getElementById('question-input').value = '';
    }
    
    function selectSpread(type, count, name) {
        currentSpread = { type, count, name };
        document.getElementById('spread-title').textContent = name;
        
        hideAllScreens();
        document.getElementById('question-screen').classList.remove('hidden');
    }
    
    async function startDrawing() {
        const question = document.getElementById('question-input').value.trim();
        
        if (!question) {
            alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–¥–∞–π—Ç–µ —Å–≤–æ–π –≤–æ–ø—Ä–æ—Å');
            return;
        }
        
        hideAllScreens();
        document.getElementById('cards-screen').classList.remove('hidden');
        document.getElementById('result-title').textContent = currentSpread.name;
        
        const container = document.getElementById('cards-container');
        container.innerHTML = '';
        
        for (let i = 0; i < currentSpread.count; i++) {
            const cardDiv = document.createElement('div');
            cardDiv.className = 'tarot-card empty';
            cardDiv.id = `card-${i}`;
            cardDiv.textContent = 'üé¥';
            container.appendChild(cardDiv);
        }
        
        const shuffled = [...tarotCards].sort(() => Math.random() - 0.5);
        drawnCards = shuffled.slice(0, currentSpread.count);
        
        for (let i = 0; i < drawnCards.length; i++) {
            await new Promise(resolve => setTimeout(resolve, 600));
            const cardDiv = document.getElementById(`card-${i}`);
            cardDiv.textContent = drawnCards[i].emoji;
            cardDiv.classList.remove('empty');
            cardDiv.classList.add('drawn');
        }
        
        await new Promise(resolve => setTimeout(resolve, 400));
        displayCardsInfo();
        
        await generateAIInterpretation(question);
        saveToHistory(question);
    }
    
    function displayCardsInfo() {
        const infoContainer = document.getElementById('cards-info');
        infoContainer.innerHTML = `
            <div class="card">
                ${drawnCards.map(card => `
                    <div class="card-info">
                        <div class="card-name">${card.emoji} ${card.name}</div>
                        <div class="card-keywords">${card.keywords}</div>
                    </div>
                `).join('')}
            </div>
        `;
    }
    
    async function generateAIInterpretation(question) {
        const container = document.getElementById('interpretation-container');
        
        container.innerHTML = `
            <div class="card">
                <div class="loading">
                    <div class="spinner">üîÆ</div>
                    <div class="loading-text">–ù–µ–π—Ä–æ—Å–µ—Ç—å –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ä–∞—Å–∫–ª–∞–¥...</div>
                </div>
            </div>
        `;
        
        const positions = {
            'daily': ['–≠–Ω–µ—Ä–≥–∏—è –¥–Ω—è'],
            'three': ['–ü—Ä–æ—à–ª–æ–µ', '–ù–∞—Å—Ç–æ—è—â–µ–µ', '–ë—É–¥—É—â–µ–µ'],
            'love': ['–í–∞—à–∏ —á—É–≤—Å—Ç–≤–∞', '–ß—É–≤—Å—Ç–≤–∞ –ø–∞—Ä—Ç–Ω–µ—Ä–∞', '–ë—É–¥—É—â–µ–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–π'],
            'career': ['–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è', '–°–∫—Ä—ã—Ç—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã', '–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è'],
            'finance': ['–î–æ—Ö–æ–¥—ã', '–†–∞—Å—Ö–æ–¥—ã', '–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π —Å–æ–≤–µ—Ç']
        };
        
        const currentPositions = positions[currentSpread.type] || ['–ó–Ω–∞—á–µ–Ω–∏–µ'];
        
        const cardsDescription = drawnCards.map((card, i) => 
            `–ü–æ–∑–∏—Ü–∏—è "${currentPositions[i]}": ${card.name} (${card.keywords})`
        ).join('\n');
        
        const prompt = `–¢—ã –æ–ø—ã—Ç–Ω—ã–π —Ç–∞—Ä–æ–ª–æ–≥. –°–¥–µ–ª–∞–π –≥–ª—É–±–æ–∫–æ–µ –∏ –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Ç–æ–ª–∫–æ–≤–∞–Ω–∏–µ —Ä–∞—Å–∫–ª–∞–¥–∞ –¢–∞—Ä–æ.
```

–¢–∏–ø —Ä–∞—Å–∫–ª–∞–¥–∞: ${currentSpread.name}
–í–æ–ø—Ä–æ—Å: ‚Äú${question}‚Äù

–ö–∞—Ä—Ç—ã –≤ —Ä–∞—Å–∫–ª–∞–¥–µ:
${cardsDescription}

–î–∞–π —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ–µ —Ç–æ–ª–∫–æ–≤–∞–Ω–∏–µ (4-5 –∞–±–∑–∞—Ü–µ–≤):

1. –û–±—â–µ–µ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–µ –æ—Ç —Ä–∞—Å–∫–ª–∞–¥–∞
1. –ü–æ–¥—Ä–æ–±–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–∞–∂–¥–æ–π –∫–∞—Ä—Ç—ã –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –µ—ë –ø–æ–∑–∏—Ü–∏–∏
1. –í–∑–∞–∏–º–æ—Å–≤—è–∑—å –∫–∞—Ä—Ç –º–µ–∂–¥—É —Å–æ–±–æ–π
1. –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∏ —Å–æ–≤–µ—Ç—ã
1. –ß–µ–≥–æ –æ–∂–∏–¥–∞—Ç—å –≤ –±–ª–∏–∂–∞–π—à–µ–º –±—É–¥—É—â–µ–º

–ü–∏—à–∏ –æ—Ç –ø–µ—Ä–≤–æ–≥–æ –ª–∏—Ü–∞ (‚Äú–Ø –≤–∏–∂—É‚Ä¶‚Äù, ‚Äú–ö–∞—Ä—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç‚Ä¶‚Äù). –ë—É–¥—å –ø—Ä–æ–Ω–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º, –º–∏—Å—Ç–∏—á–Ω—ã–º, –Ω–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º. –ò—Å–ø–æ–ª—å–∑—É–π 2-3 —ç–º–æ–¥–∑–∏ –¥–ª—è –∞—Ç–º–æ—Å—Ñ–µ—Ä—ã.`;

```
        try {
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º Groq API (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∏ –±—ã—Å—Ç—Ä—ã–π)
            const response = await fetch('https://api.groq.com/openai/v1/chat/completions', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': 'Bearer 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'
                },
                body: JSON.stringify({
                    model: 'llama-3.3-70b-versatile',
                    messages: [
                        {
                            role: 'system',
                            content: '–¢—ã –æ–ø—ã—Ç–Ω—ã–π —Ç–∞—Ä–æ–ª–æ–≥ —Å –≥–ª—É–±–æ–∫–∏–º –ø–æ–Ω–∏–º–∞–Ω–∏–µ–º —Å–∏–º–≤–æ–ª–∏–∑–º–∞ –∫–∞—Ä—Ç –¢–∞—Ä–æ. –î–∞—ë—à—å –ø–æ–¥—Ä–æ–±–Ω—ã–µ, –º–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –∏ —Ç–æ—á–Ω—ã–µ —Ç–æ–ª–∫–æ–≤–∞–Ω–∏—è.'
                        },
                        {
                            role: 'user',
                            content: prompt
                        }
                    ],
                    temperature: 0.8,
                    max_tokens: 1500
                })
            });

            const data = await response.json();
            
            if (data.choices && data.choices[0] && data.choices[0].message) {
                const aiText = data.choices[0].message.content;
                
                container.innerHTML = `
                    <div class="card">
                        <h3 style="margin-bottom: 16px; display: flex; align-items: center;">
                            –¢–æ–ª–∫–æ–≤–∞–Ω–∏–µ <span class="ai-badge">AI</span>
                        </h3>
                        <div class="interpretation">
                            ${aiText.split('\n\n').map(p => p.trim() ? `<p>${p}</p>` : '').join('')}
                        </div>
                    </div>
                `;
            } else {
                throw new Error('–û—à–∏–±–∫–∞ –æ—Ç–≤–µ—Ç–∞ API');
            }
            
        } catch (error) {
            console.error('AI Error:', error);
            // –ï—Å–ª–∏ API –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –±–∞–∑–æ–≤–æ–µ —Ç–æ–ª–∫–æ–≤–∞–Ω–∏–µ
            container.innerHTML = `
                <div class="card">
                    <h3 style="margin-bottom: 16px;">–¢–æ–ª–∫–æ–≤–∞–Ω–∏–µ</h3>
                    <div class="interpretation">
                        ${getBasicInterpretation(question, currentPositions)}
                    </div>
                </div>
            `;
        }
    }
    
    function getBasicInterpretation(question, positions) {
        const meanings = {
            0: '–®—É—Ç –ø—Ä–∏–∑—ã–≤–∞–µ—Ç –≤–∞—Å –∫ —Å–ø–æ–Ω—Ç–∞–Ω–Ω–æ—Å—Ç–∏ –∏ –Ω–æ–≤—ã–º –Ω–∞—á–∏–Ω–∞–Ω–∏—è–º. –ù–µ –±–æ–π—Ç–µ—Å—å —Ä–∏—Å–∫–æ–≤–∞—Ç—å.',
            1: '–ú–∞–≥ –≥–æ–≤–æ—Ä–∏—Ç –æ —Ç–æ–º, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å –≤—Å–µ —Ä–µ—Å—É—Ä—Å—ã –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏.',
            2: '–í–µ—Ä—Ö–æ–≤–Ω–∞—è –ñ—Ä–∏—Ü–∞ —Å–æ–≤–µ—Ç—É–µ—Ç –¥–æ–≤–µ—Ä–∏—Ç—å—Å—è –∏–Ω—Ç—É–∏—Ü–∏–∏ –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º—É –≥–æ–ª–æ—Å—É.',
            3: '–ò–º–ø–µ—Ä–∞—Ç—Ä–∏—Ü–∞ –æ–±–µ—â–∞–µ—Ç –ø–µ—Ä–∏–æ–¥ –∏–∑–æ–±–∏–ª–∏—è, —Ä–æ—Å—Ç–∞ –∏ —Ç–≤–æ—Ä—á–µ—Å–∫–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.',
            4: '–ò–º–ø–µ—Ä–∞—Ç–æ—Ä —Ç—Ä–µ–±—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã –∏ —á–µ—Ç–∫–æ–≥–æ –ø–ª–∞–Ω–∞ –¥–µ–π—Å—Ç–≤–∏–π.',
            5: '–ò–µ—Ä–æ—Ñ–∞–Ω—Ç —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –≤–∞–∂–Ω–æ—Å—Ç—å —Ç—Ä–∞–¥–∏—Ü–∏–π –∏ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –º—É–¥—Ä–æ—Å—Ç–∏.',
            6: '–í–ª—é–±–ª–µ–Ω–Ω—ã–µ —Å—Ç–∞–≤—è—Ç –ø–µ—Ä–µ–¥ –≤–∞–º–∏ –≤–∞–∂–Ω—ã–π –≤—ã–±–æ—Ä. –°–ª–µ–¥—É–π—Ç–µ –∑–æ–≤—É —Å–µ—Ä–¥—Ü–∞.',
            7: '–ö–æ–ª–µ—Å–Ω–∏—Ü–∞ –≥–æ–≤–æ—Ä–∏—Ç –æ –ø–æ–±–µ–¥–µ —á–µ—Ä–µ–∑ —Ä–µ—à–∏–º–æ—Å—Ç—å –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å.',
            8: '–°–∏–ª–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–µ—Ç, —á—Ç–æ –∏—Å—Ç–∏–Ω–Ω–∞—è —Å–∏–ª–∞ –≤ –º—è–≥–∫–æ—Å—Ç–∏ –∏ —Ç–µ—Ä–ø–µ–Ω–∏–∏.',
            9: '–û—Ç—à–µ–ª—å–Ω–∏–∫ –ø—Ä–∏–∑—ã–≤–∞–µ—Ç –∫ —É–µ–¥–∏–Ω–µ–Ω–∏—é –∏ —Å–∞–º–æ–ø–æ–∑–Ω–∞–Ω–∏—é.',
            10: '–ö–æ–ª–µ—Å–æ –§–æ—Ä—Ç—É–Ω—ã –ø—Ä–µ–¥–≤–µ—â–∞–µ—Ç –≤–∞–∂–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω—ã –≤ –≤–∞—à–µ–π –∂–∏–∑–Ω–∏.',
            11: '–°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å –æ–±–µ—â–∞–µ—Ç, —á—Ç–æ –∏—Å—Ç–∏–Ω–∞ –∏ –±–∞–ª–∞–Ω—Å –≤–æ—Å—Ç–æ—Ä–∂–µ—Å—Ç–≤—É—é—Ç.',
            12: '–ü–æ–≤–µ—à–µ–Ω–Ω—ã–π –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –≤–∑–≥–ª—è–Ω—É—Ç—å –Ω–∞ —Å–∏—Ç—É–∞—Ü–∏—é —Å –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã.',
            13: '–°–º–µ—Ä—Ç—å —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É–µ—Ç —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –æ—Ç —Å—Ç–∞—Ä–æ–≥–æ.',
            14: '–£–º–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å —Å–æ–≤–µ—Ç—É–µ—Ç –Ω–∞–π—Ç–∏ –±–∞–ª–∞–Ω—Å –∏ –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ.',
            15: '–î—å—è–≤–æ–ª –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–µ—Ç –æ–± –∏–ª–ª—é–∑–∏—è—Ö –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö.',
            16: '–ë–∞—à–Ω—è –ø—Ä–µ–¥–≤–µ—â–∞–µ—Ç —Ä–∞–∑—Ä—É—à–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ.',
            17: '–ó–≤–µ–∑–¥–∞ –ø—Ä–∏–Ω–æ—Å–∏—Ç –Ω–∞–¥–µ–∂–¥—É, –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ –∏ –∏—Å—Ü–µ–ª–µ–Ω–∏–µ.',
            18: '–õ—É–Ω–∞ –≥–æ–≤–æ—Ä–∏—Ç –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è —Å–æ —Å—Ç—Ä–∞—Ö–∞–º–∏.',
            19: '–°–æ–ª–Ω—Ü–µ –æ–±–µ—â–∞–µ—Ç —É—Å–ø–µ—Ö, —Ä–∞–¥–æ—Å—Ç—å –∏ —è—Å–Ω–æ—Å—Ç—å.',
            20: '–°—É–¥ –ø—Ä–∏–∑—ã–≤–∞–µ—Ç –∫ –≤–æ–∑—Ä–æ–∂–¥–µ–Ω–∏—é –∏ –Ω–æ–≤–æ–º—É –ø—Ä–∏–∑–≤–∞–Ω–∏—é.',
            21: '–ú–∏—Ä —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ü–∏–∫–ª–∞ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏.'
        };
        
        let interpretation = `<p><strong>–í–æ–ø—Ä–æ—Å:</strong> ${question}</p>`;
        interpretation += '<p><strong>–û–±—â–µ–µ —Ç–æ–ª–∫–æ–≤–∞–Ω–∏–µ:</strong></p>';
        
        drawnCards.forEach((card, i) => {
            interpretation += `<p><strong>${positions[i]}:</strong> ${meanings[card.id]}</p>`;
        });
        
        interpretation += '<p><strong>–°–æ–≤–µ—Ç:</strong> –ö–∞—Ä—Ç—ã —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –≤–∞–∂–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤ –≤–∞—à–µ–π –∂–∏–∑–Ω–∏. –ü—Ä–∏—Å–ª—É—à–∞–π—Ç–µ—Å—å –∫ –∏—Ö –ø–æ—Å–ª–∞–Ω–∏—é –∏ –¥–µ–π—Å—Ç–≤—É–π—Ç–µ —Å –º—É–¥—Ä–æ—Å—Ç—å—é –∏ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ—Å—Ç—å—é.</p>';
        
        return interpretation;
    }
    
    function saveToHistory(question) {
        const reading = {
            id: Date.now(),
            date: new Date().toISOString(),
            spreadType: currentSpread.type,
            spreadName: currentSpread.name,
            question: question,
            cards: drawnCards.map(c => ({ emoji: c.emoji, name: c.name }))
        };
        
        history.unshift(reading);
        history = history.slice(0, 20);
        localStorage.setItem('tarotHistory', JSON.stringify(history));
    }
    
    function showHistory() {
        hideAllScreens();
        document.getElementById('history-screen').classList.remove('hidden');
        
        const historyList = document.getElementById('history-list');
        
        if (history.length === 0) {
            historyList.innerHTML = `
                <div class="card">
                    <div class="empty-state">
                        <div class="empty-icon">üìú</div>
                        <div class="empty-text">–ü–æ–∫–∞ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Ä–∞—Å–∫–ª–∞–¥–æ–≤</div>
                    </div>
                </div>
            `;
            return;
        }
        
        historyList.innerHTML = history.map(reading => {
            const date = new Date(reading.date);
            const dateStr = date.toLocaleDateString('ru-RU', { 
                day: 'numeric', 
                month: 'short',
                hour: '2-digit',
                minute: '2-digit'
            });
            
            return `
                <div class="history-item">
                    <div class="history-header">
                        <div class="history-spread">${reading.spreadName}</div>
                        <div class="history-date">${dateStr}</div>
                    </div>
                    <div class="history-cards">
                        ${reading.cards.map(c => c.emoji).join(' ')}
                    </div>
                    ${reading.question ? `
                        <div class="history-question">"${reading.question}"</div>
                    ` : ''}
                </div>
            `;
        }).join('');
    }
    
    function showLearn() {
        hideAllScreens();
        document.getElementById('learn-screen').classList.remove('hidden');
        
        const learnList = document.getElementById('learn-list');
        learnList.innerHTML = tarotCards.map(card => `
            <div class="learn-item">
                <div class="learn-emoji">${card.emoji}</div>
                <div class="learn-info">
                    <div class="learn-name">${card.name}</div>
                    <div class="learn-keywords">${card.keywords}</div>
                </div>
            </div>
        `).join('');
    }
</script>
```

</body>
</html>
